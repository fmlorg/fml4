		How to maintain fml CVS repository

				Ken'ichi Fukamachi
				<fukachan@fml.org>
				1999 January

Caution: you need "BSD make" not gmake.

-----------------------------------------------------------------
* Firstly cvs checkout !

0.	set up TCP/IP to the Internet if needed. 

1.	checkout fml repository

	% setenv CVSROOT cvs.fml.org:/cvsroot
	% cvs co fml
	% cd fml

1.1	If you are the maintainer to make 'snapshot', you need to set up 
	distrib/history. The repository distrib/history is special. 
	Please check out it:

	% cd distrib
	% cvs co history

where 'history' is the alias of 'release/history'. This directory is
ignored in fml/ repository since it is maintained separetely.

2.	generate pkgsrc/. NOTE: You need Intenet connection to 'make pkgsrc'. 

	% make pkgsrc

3.	run "make build", which process follows:

	% touch .info	(or get the latest .info)
	% make plaindoc
	% make htmldoc

which generate basic snapshot without pkgsrc and stop just before
tar.gz.

4.	O.K., now start your hack!


5.	When you make distribution, you need several programs
	such as ssh, rsync, .... Please see distrib/mk/fml.prog.mk 
	for more details.


-----------------------------------------------------------------
* The fml master maintainer who is responsible for e.g. snapshot generation
  should check the version number

0.	check conf/.

	conf/release			2.2A      ;;; main trunk version
	conf/release_version		2.2A#100  ;;; snapshot (not in cvs)
	conf/branch			current, stable, etc...
					which reflects ftp servre hier(7).

"conf/release" is the main trunk revision, which should be set up by hand.
distrib/bin/fml_version.pl controls "conf/release_version".

1.	define the current snapshot number "conf/release_version".

You need to set "conf/release" based on information not in cvs.


-----------------------------------------------------------------
* CVS on cvs.fml.org  NetBSD-current/newsmips (1.3I)

^fml
		-> source-changes@fml.org 
		-> /cvsroot/log/fml/commitlog

^fml/doc
		-> doc-changes@fml.org 
		-> source-changes@fml.org 
		-> /cvsroot/log/fml/commitlog

^fml/distrib/history
		-> /cvsroot/log/fml/commitlog

-----------------------------------------------------------------
* TAG, BRANCH

When you make "fml x.y.z release", you will work on the branch split
off from the main trunk. For example

	   2.2 -----> 2.2 A --*--> 2.2B ----->	(main trunk)
	                      |
	                  2.2.1 BETA		(branch)
	                      |			(* == fml-2-2-bb0)
	                  2.2.1 Release

If you do "make snapshot", the following "make_wrapper" may be useful.

	#!/bin/sh
	FML=$PWD;            export FML
	BRANCH_SNAPSHOT=yes; export BRANCH_SNAPSHOT
	exec make $*

If $BRANCH_SNAPSHOT is set, distrib/bin/generator does not synchronize
the fml distribution with www and ftp/snapshot/ directory.


[ALREADY ASSIGNED TAGS]

fml-2-1		2.1 Release
fml-2-2		2.2 Release
fml-2-2A-end	the end point of 2.2A
fml-2-2-bb0	2.2 release working branch line
		which is the road to 2.2.1.
fml-2-2-1-prep	== fml-2-2-bb0's alias
		the road to 2.2.1

fml-2-2A-end	2.2A end
fml-2-2D	2.2D start
fml-2-2D-start	2.2D start

fml-3-0-maint	3.0 release branch
fml-3-0-bb0	3.0_BETA start point
fml-3-0		3.0 release
		XXX: update -j fml-3-0-maint:"1999-8-16 00:39" -j fml-3-0-maint
